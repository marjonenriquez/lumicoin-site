<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>The Health Dividend Simulator: How Prevention Pays</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap');
  @import url('https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200');

  :root {
    --bg: linear-gradient(135deg, #0ea5e9 0%, #8b5cf6 50%, #3b82f6 100%);
    --card-bg: #ffffff;
    --shadow: 0 4px 16px -4px rgba(0,0,0,0.08), 0 2px 8px -2px rgba(0,0,0,0.04);
    --shadow-lg: 0 20px 40px -12px rgba(0,0,0,0.15), 0 8px 16px -6px rgba(0,0,0,0.08);
    --shadow-xl: 0 25px 50px -12px rgba(0,0,0,0.25);
    --ink-primary: #0f172a; --ink-secondary: #475569; --ink-muted: #64748b; --ink-light: #ffffff;
    --brand-primary: #6366f1; --brand-success: #10b981;
    --success: #059669; --success-light: #ecfdf5; --failure: #dc2626; --failure-light: #fef2f2;
    --patient-color: #059669; --provider-color: #0284c7; --system-color: #4338ca; --device-color: #db2777; --platform-color: #7c3aed;
  }

  * { box-sizing: border-box; }
  body { 
    margin: 0; 
    font-family: 'Inter', sans-serif; 
    font-size: 16px; 
    line-height: 1.6; 
    background: #f8fafc;
    background-image: 
      radial-gradient(circle at 25% 25%, rgba(99, 102, 241, 0.05) 0%, transparent 50%),
      radial-gradient(circle at 75% 75%, rgba(139, 92, 246, 0.05) 0%, transparent 50%);
    color: var(--ink-primary); 
    overflow-x: hidden; 
    scroll-behavior: smooth;
  }
  
  .material-symbols-outlined { 
    font-variation-settings: 'FILL' 0, 'wght' 400, 'GRAD' 0, 'opsz' 24; 
    font-size: 20px; 
    vertical-align: middle; 
  }

  .hero { 
    padding: 80px 24px 96px; 
    background: var(--bg); 
    color: var(--ink-light); 
    text-align: center; 
    position: relative;
    overflow: hidden;
  }
  
  .hero::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: url('data:image/svg+xml,<svg width="60" height="60" viewBox="0 0 60 60" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><g fill="%23ffffff" fill-opacity="0.03"><circle cx="30" cy="30" r="1.5"/></g></svg>');
    animation: float 20s ease-in-out infinite;
  }
  
  @keyframes float {
    0%, 100% { transform: translateY(0px) rotate(0deg); }
    50% { transform: translateY(-20px) rotate(180deg); }
  }
  
  .hero h1 { 
    font-size: clamp(2.5rem, 6vw, 4rem); 
    font-weight: 800; 
    margin: 0 0 16px; 
    letter-spacing: -0.03em;
    background: linear-gradient(135deg, #ffffff 0%, rgba(255,255,255,0.8) 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    position: relative;
    z-index: 1;
  }
  
  .hero .subheader {
    font-size: 2.25rem;
    font-weight: 550;
    margin: 4px 0 24px 0; 
    opacity: 0.95;
    background: linear-gradient(135deg, #ffffff 0%, rgba(255,255,255,0.85) 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    position: relative;
    z-index: 1;
  }

  
  .hero .subtitle { 
    font-size: 1.3rem; 
    font-weight: 500; 
    opacity: 0.95; 
    max-width: 900px; 
    margin: 0 auto;
    line-height: 1.7;
    position: relative;
    z-index: 1;
  }

  .wrap { 
    max-width: 1200px; 
    margin: 0 auto; 
    padding: 64px 24px; 
  }
  
  .step-header { 
    display: flex; 
    align-items: center; 
    gap: 20px; 
    margin-bottom: 32px;
    opacity: 0;
    transform: translate3d(0, 20px, 0);
    animation: slideInUp 0.6s ease-out forwards;
  }
  
  @keyframes slideInUp {
    to {
      opacity: 1;
      transform: translate3d(0, 0, 0);
    }
  }
  
  .step-number { 
    background: linear-gradient(135deg, var(--brand-primary) 0%, #8b5cf6 100%);
    color: var(--ink-light); 
    width: 48px; 
    height: 48px; 
    border-radius: 16px; 
    display: grid; 
    place-items: center; 
    font-weight: 800; 
    font-size: 1.4rem;
    box-shadow: var(--shadow-lg);
    position: relative;
    flex-shrink: 0;
  }
  
  .step-header h2 { 
    font-size: 2.2rem; 
    font-weight: 700; 
    margin: 0;
    background: linear-gradient(135deg, var(--ink-primary) 0%, var(--ink-secondary) 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
  }

  .card { 
    background: var(--card-bg); 
    border: 1px solid #e2e8f0; 
    border-radius: 24px; 
    box-shadow: var(--shadow); 
    padding: 32px; 
    transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1), box-shadow 0.3s cubic-bezier(0.4, 0, 0.2, 1), border-color 0.3s ease;
    position: relative;
    overflow: hidden;
  }
  
  .card.danger-outline {
    border-color: var(--failure);
    box-shadow: 0 0 0 1px var(--failure), var(--shadow);
  }

  .card:hover {
    transform: translateY(-2px);
    box-shadow: var(--shadow-lg);
  }
  
  .grid { display: grid; gap: 24px; }
  @media(min-width: 768px){ .grid-2 { grid-template-columns: repeat(2, 1fr); } }
  @media(min-width: 1024px){ .grid-3 { grid-template-columns: repeat(3, 1fr); } }
  @media(min-width: 1200px){ .grid-4 { grid-template-columns: repeat(4, 1fr); } }

  .section-label { 
    font-size: 1.125rem; 
    font-weight: 600; 
    color: var(--ink-primary); 
    margin-bottom: 20px; 
    display: block;
    line-height: 1.6;
  }
  
  .choice-card { 
    border: 2px solid #e2e8f0; 
    border-radius: 20px; 
    padding: 24px; 
    cursor: pointer; 
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); 
    position: relative; 
    background: linear-gradient(135deg, #fafafa 0%, #f8fafc 100%);
    text-align: center; 
    display: flex; 
    flex-direction: column; 
    justify-content: space-between;
    overflow: hidden;
    will-change: transform, box-shadow, border-color;
  }
  
  .choice-card:hover {
    transform: translateY(-4px) scale(1.02);
    box-shadow: var(--shadow-lg);
    border-color: var(--brand-primary);
  }
  
  .choice-card.selected { 
    border-color: var(--brand-primary); 
    background: linear-gradient(135deg, #ffffff 0%, #f0f4ff 100%);
    box-shadow: var(--shadow-lg);
    transform: translateY(-2px);
  }
  
  .choice-card .material-symbols-outlined {
    color: var(--brand-primary);
    margin-bottom: 12px;
    transition: all 0.3s ease;
  }
  
  .choice-card:hover .material-symbols-outlined,
  .choice-card.selected .material-symbols-outlined {
    transform: scale(1.1);
    filter: drop-shadow(0 4px 8px rgba(99, 102, 241, 0.2));
  }
  
  .choice-card h3 { 
    margin: 12px 0 8px; 
    font-size: 1.125rem;
    font-weight: 600;
    color: var(--ink-primary);
  }
  
  .choice-card p { 
    margin: 0; 
    color: var(--ink-secondary); 
    font-size: 0.95rem; 
    flex-grow: 1;
    line-height: 1.5;
  }
  
  .btn { 
    display: flex; 
    width: 100%; 
    align-items: center; 
    justify-content: center; 
    gap: 12px; 
    border-radius: 16px; 
    border: 0; 
    padding: 18px 32px; 
    font-weight: 700; 
    font-size: 1.25rem; 
    cursor: pointer; 
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    position: relative;
    overflow: hidden;
    will-change: transform, box-shadow;
    margin-top: 24px; /* Added margin */
  }

  .btn.primary {
    color: var(--ink-light); 
    background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
  }
  
  .btn.primary:hover {
    transform: translateY(-2px);
    box-shadow: var(--shadow-xl);
  }
  
  .btn:disabled { 
    background: #e2e8f0;
    color: var(--ink-muted);
    opacity: 0.8;
    cursor: not-allowed; 
    transform: none; 
    box-shadow: none; 
  }
  
  .track-container { 
    background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
    border: 1px solid #e2e8f0; 
    border-radius: 24px; 
    padding: 60px 40px 40px; 
    position: relative; 
    overflow: hidden; 
    min-height: 280px;
    box-shadow: var(--shadow);
  }
  
  .track-line { 
    position: absolute; 
    left: 70px; 
    right: 70px; 
    top: 50%; 
    height: 8px; 
    background: linear-gradient(90deg, #e2e8f0 0%, #cbd5e1 50%, #e2e8f0 100%);
    border-radius: 4px; 
    transform: translate3d(0, -24px, 0);
    box-shadow: inset 0 2px 4px rgba(0,0,0,0.1);
  }
  
  .stations { 
    display: flex; 
    justify-content: space-between; 
    position: relative; 
    margin-top: 16px; 
  }
  
  .station { 
    display: flex; 
    flex-direction: column; 
    align-items: center; 
    gap: 16px; 
    width: 140px; 
    text-align: center; 
    position: relative; 
  }
  
  .station-icon { 
    width: 80px; 
    height: 80px; 
    border-radius: 24px; 
    background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
    border: 3px solid #e2e8f0; 
    display: grid; 
    place-items: center; 
    transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1); 
    position: relative; 
    z-index: 2;
    box-shadow: var(--shadow);
  }
  
  .station-icon .material-symbols-outlined { 
    font-size: 40px; 
    color: var(--ink-secondary);
    transition: all 0.3s ease;
  }
  
  .station-name { 
    font-weight: 600; 
    font-size: 0.95rem;
    color: var(--ink-primary);
  }
  
  .payout { 
    position: absolute; 
    bottom: calc(100% + 16px);
    left: 50%;
    padding: 8px 16px; 
    border-radius: 12px; 
    font-size: 0.9rem; 
    font-weight: 700; 
    white-space: nowrap; 
    opacity: 0; 
    transform: translate3d(-50%, 10px, 0) scale(0.8); 
    transition: all 0.5s cubic-bezier(0.34, 1.56, 0.64, 1); 
    z-index: 10; 
    color: white;
    box-shadow: var(--shadow-lg);
    will-change: transform, opacity;
  }
  
  .payout.show { 
    transform: translate3d(-50%, 0, 0) scale(1); 
    opacity: 1; 
  }

  #dividendVehicle { 
    position: absolute; 
    top: 50%; 
    left: 0; 
    transform: translate3d(42px, -24px, 0); 
    width: 56px; 
    height: 56px; 
    border-radius: 16px; 
    display: grid; 
    place-items: center; 
    background: linear-gradient(135deg, var(--brand-success) 0%, #059669 100%);
    box-shadow: var(--shadow-lg); 
    z-index: 5; 
    transition: transform 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    will-change: transform;
  }
  
  .station-icon.success { 
    border-color: var(--brand-success) !important; 
    background: linear-gradient(135deg, var(--success-light) 0%, #f0fdf4 100%) !important;
    animation: successPop 0.6s cubic-bezier(0.34, 1.56, 0.64, 1); 
    transform: scale(1.1);
    box-shadow: 0 8px 25px -8px rgba(16, 185, 129, 0.4);
  }
  
  @keyframes successPop { 
    0% { transform: scale(1); } 
    50% { transform: scale(1.25) rotate(5deg); } 
    100% { transform: scale(1.1) rotate(0deg); } 
  }
  
  .results-grid { display: grid; gap: 32px; }
  @media(min-width: 1024px) { .results-grid { grid-template-columns: 320px 1fr; } }
  
  .finalResult { 
    border-radius: 20px; 
    padding: 24px; 
    opacity: 0; 
    transform: scale(0.9) translate3d(0, 20px, 0); 
    transition: opacity 0.5s cubic-bezier(0.34, 1.56, 0.64, 1), transform 0.5s cubic-bezier(0.34, 1.56, 0.64, 1); 
    margin-top: 24px; 
    visibility: hidden;
  }
  
  .finalResult.show { 
    opacity: 1; 
    transform: scale(1) translate3d(0, 0, 0); 
    visibility: visible;
  }
  
  .finalResult.success { 
    background: linear-gradient(135deg, var(--success-light) 0%, #ecfdf5 100%);
    color: var(--success); 
    border: 2px solid var(--success);
    box-shadow: 0 8px 25px -8px rgba(16, 185, 129, 0.2);
  }

  .finalResult.payer {
    background: linear-gradient(135deg, #eef2ff 0%, #f0f4ff 100%);
    color: var(--brand-primary);
    border: 2px solid var(--brand-primary);
    box-shadow: 0 8px 25px -8px rgba(99, 102, 241, 0.2);
  }
  
  .finalResult.fail { 
    background: linear-gradient(135deg, var(--failure-light) 0%, #fef2f2 100%);
    color: var(--failure); 
    border: 2px solid var(--failure);
    box-shadow: 0 8px 25px -8px rgba(220, 38, 38, 0.2);
  }
  
  .result-title { 
    font-size: 1.3rem; 
    font-weight: 700; 
    margin-bottom: 8px;
    display: flex;
    align-items: center;
    gap: 8px;
  }
  
  .reason { 
    font-size: 1rem; 
    font-weight: 500; 
    line-height: 1.6;
    color: var(--ink-secondary); 
  }

  #ledger { visibility: hidden; opacity: 0; transition: opacity 0.5s ease; }
  #ledger.show { visibility: visible; opacity: 1; }
  
  .split-row { 
    display: flex; 
    justify-content: space-between; 
    align-items: center; 
    padding: 16px 0; 
    border-bottom: 1px solid #f1f5f9; 
  }
  
  .split-row:last-child { border: 0; }
  
  .split-row .label { 
    font-weight: 600; 
    display: flex; 
    align-items: flex-start; 
    gap: 12px; 
  }
  
  .split-row .label-desc { 
    font-size: 0.85rem; 
    color: var(--ink-muted); 
    display: block; 
    font-weight: 400;
    margin-top: 4px;
    line-height: 1.4;
  }
  
  .split-row .value { 
    font-weight: 700; 
    font-size: 1.125rem; 
    text-align: right; 
  }
  
  .total-row { 
    margin-top: 12px; 
    border-top: 2px solid #e2e8f0 !important; 
    padding-top: 16px !important; 
  }
  
  .total-row .value { 
    color: var(--ink-primary); 
    font-size: 1.25rem;
  }

  #analysis { 
    visibility: hidden;
    opacity: 0;
    margin-top: 32px; 
  }
  
  #analysis.show {
    visibility: visible;
    opacity: 1;
    animation: fadeInUp 0.6s ease-out 0.3s forwards;
  }
  
  @keyframes fadeInUp {
    from { opacity: 0; transform: translate3d(0, 20px, 0); }
    to { opacity: 1; transform: translate3d(0, 0, 0); }
  }
  
  .analysis-card { 
    background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
    border: 1px solid #e2e8f0;
    border-radius: 20px; 
    padding: 28px;
  }
    
  .analysis-card h4 { 
    margin: 0 0 16px; 
    display: flex; 
    align-items: center; 
    gap: 12px; 
    font-size: 1.2rem;
    color: var(--ink-primary);
  }
    
  .analysis-card p { 
    margin: 0; 
    color: var(--ink-secondary); 
    font-size: 1rem; 
    line-height: 1.7; 
  }
  
  details { 
    background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
    border: 1px solid #e2e8f0; 
    border-radius: 20px; 
    padding: 20px 24px; 
    margin-top: 32px;
  }
    
  details summary { 
    font-weight: 600; 
    cursor: pointer; 
    display: flex; 
    align-items: center; 
    gap: 12px;
    color: var(--ink-primary);
    list-style: none;
    position: relative;
    padding-right: 24px;
  }
  
  details summary::-webkit-details-marker { display: none; }
  
  details summary::after {
    content: 'expand_more';
    font-family: 'Material Symbols Outlined';
    position: absolute;
    right: 0;
    transition: transform 0.2s ease;
  }
  
  details[open] summary::after {
    transform: rotate(180deg);
  }
  
  .qaly-info { 
    margin-top: 20px; 
    border-top: 1px solid #e2e8f0; 
    padding-top: 20px; 
    font-size: 0.95rem; 
    color: var(--ink-secondary); 
  }
  
  .qaly-info strong { 
    color: var(--ink-primary); 
  }

  .toggle-switch { 
    display: flex; 
    border-radius: 16px; 
    margin-bottom: 32px;
    background: #ffffff;
    box-shadow: var(--shadow);
    position: relative;
    padding: 4px;
  }
  
  .toggle-btn { 
    flex: 1; 
    padding: 12px 24px; 
    text-align: center; 
    font-weight: 600; 
    cursor: pointer; 
    color: var(--ink-secondary); 
    transition: color 0.3s cubic-bezier(0.4, 0, 0.2, 1); 
    border: none; 
    font-size: 1rem;
    position: relative;
    z-index: 1;
    background: transparent;
  }
  
  .toggle-btn.active { 
    color: #ffffff;
  }
  
  #toggle-slider {
    position: absolute;
    top: 4px;
    left: 4px;
    height: calc(100% - 8px);
    width: calc(50% - 4px);
    background: linear-gradient(135deg, var(--brand-primary) 0%, #8b5cf6 100%);
    border-radius: 12px;
    transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    z-index: 0;
  }
  
  .amount-wrapper {
    text-align: center; 
    display: block; 
    padding: 32px 20px;
    border-radius: 20px;
    transition: all 0.3s ease;
  }
  
  .amount-wrapper.success {
    background: linear-gradient(135deg, rgba(16, 185, 129, 0.05) 0%, rgba(5, 150, 105, 0.05) 100%);
    border: 1px solid rgba(16, 185, 129, 0.1);
  }
  
  .amount-wrapper.fail {
    background: linear-gradient(135deg, rgba(220, 38, 38, 0.05) 0%, rgba(185, 28, 28, 0.05) 100%);
    border: 1px solid rgba(220, 38, 38, 0.1);
  }
    
  .amount-wrapper .value-label {
    font-size: 1.125rem;
    font-weight: 500;
  }

  .amount-wrapper .value { 
    font-size: 3rem; 
    font-weight: 800;
  }

  #dividendLabel {
    color: var(--brand-success);
    background: linear-gradient(135deg, var(--brand-success) 0%, #059669 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
  }
  #futureCostLabel {
    color: var(--failure);
    background: linear-gradient(135deg, var(--failure) 0%, #b91c1c 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
  }
  
  hr { 
    border: 0; 
    height: 2px;
    background: linear-gradient(90deg, transparent, #e2e8f0, transparent);
    margin: 64px 0;
  }

  input[type="range"] {
    -webkit-appearance: none;
    appearance: none;
    width: 100%;
    height: 8px;
    border-radius: 4px;
    background: #e2e8f0;
    outline: none;
  }

  input[type="range"]::-webkit-slider-thumb {
    -webkit-appearance: none;
    appearance: none;
    width: 24px;
    height: 24px;
    border-radius: 50%;
    background: linear-gradient(135deg, var(--brand-primary) 0%, #8b5cf6 100%);
    cursor: pointer;
    box-shadow: var(--shadow);
  }

  /* Mobile responsiveness */
  @media (max-width: 768px) {
    .wrap { padding: 32px 16px; }
    .step-header h2 { font-size: 1.75rem; }
    .card { padding: 24px; }
    .grid-4 { grid-template-columns: repeat(2, 1fr); }
    .track-container { padding: 50px 24px 32px; }
    .station { width: auto; flex: 1; }
    .station-icon { width: 60px; height: 60px; }
    #dividendVehicle { width: 44px; height: 44px; transform: translate3d(28px, -22px, 0); }
    .stations { gap: 10px; }
    .track-line { left: 40px; right: 40px;}
    .results-grid { grid-template-columns: 1fr; }
  }

  @media (prefers-reduced-motion: reduce) {
    * { animation: none !important; transition-duration: 0.01ms !important; }
  }

  .choice-card:focus-visible, .btn:focus-visible, .toggle-btn:focus-visible, details summary:focus-visible {
    outline: 3px solid var(--brand-primary);
    outline-offset: 3px;
    border-radius: 16px;
  }

  .payer-benefits {
    list-style: none;
    padding: 0;
    margin-top: 16px;
    text-align: left;
  }
  .payer-benefits li {
    display: flex;
    align-items: flex-start;
    gap: 12px;
    margin-bottom: 12px;
  }
  .payer-benefits li:last-child {
    margin-bottom: 0;
  }
  .payer-benefits b {
    color: var(--brand-primary);
  }
  .payer-benefits .material-symbols-outlined {
    color: var(--brand-primary);
    margin-top: 2px;
    font-size: 18px;
  }
</style>
</head>
  
<body>
  
  <div class="hero">
  <h1>LümiCoin’s Health Dividend</h1>
  <h2 class="subheader">See How Prevention Finally Pays</h2>
  <p class="subtitle">
    Our healthcare system only pays when you get sick. This simulator shows how LümiCoin rewires the economics — turning your family's healthy actions into real, shared value for everyone.
  </p>
</div>

  <div class="wrap">
    <section>
      <div class="step-header"><div class="step-number">1</div><h2>A Healthy Action Occurs</h2></div>
      <div class="card">
        <label class="section-label">A member of a health plan completes a verified preventive action.</label>
        <div id="action-choices" class="grid grid-4">
            <div class="choice-card selected" data-action="steps" data-qaly="0.0005" tabindex="0">
                <span class="material-symbols-outlined" style="font-size:32px;">directions_walk</span>
                <h3>Consistent Walking</h3>
                <p>Achieving a daily step goal for a full month.</p>
            </div>
            <div class="choice-card" data-action="sleep" data-qaly="0.00075" tabindex="0">
                 <span class="material-symbols-outlined" style="font-size:32px;">bed</span>
                <h3>Improved Sleep</h3>
                <p>Meeting a consistent sleep target for a month.</p>
            </div>
            <div class="choice-card" data-action="meds" data-qaly="0.0015" tabindex="0">
                 <span class="material-symbols-outlined" style="font-size:32px;">medication</span>
                <h3>Medication Adherence</h3>
                <p>Taking prescribed medication correctly for 90 days.</p>
            </div>
            <div class="choice-card" data-action="biomarker" data-qaly="0.0025" tabindex="0">
                 <span class="material-symbols-outlined" style="font-size:32px;">biotech</span>
                <h3>Better Biomarkers</h3>
                <p>Lowering cholesterol, verified by a lab test.</p>
            </div>
        </div>
        <details id="advanced-settings">
            <summary><span class="material-symbols-outlined">tune</span>Advanced Settings</summary>
            <div class="qaly-info">
                <p>A <strong>QALY</strong> (Quality-Adjusted Life Year) is the gold standard for measuring health outcomes. <strong>1 QALY = 1 year in perfect health.</strong> Insurers use it to value expensive drugs; we use it to value proactive prevention.</p>
                <label class="section-label" style="margin-top: 16px;">Insurer's Agreed Value per QALY:</label>
                <div style="display: flex; align-items: center; gap: 16px;">
                    <input id="qalyValue" type="range" min="50000" max="250000" value="100000" step="5000" />
                    <b id="qalyValueLabel">$100,000</b>
                </div>
            </div>
        </details>
      </div>
    </section>

    <hr/>
    
    <section>
      <div class="step-header"><div class="step-number">2</div><h2>The Result: With vs. Without LümiCoin</h2></div>
        <div class="toggle-switch">
            <div id="toggle-slider"></div>
            <button class="toggle-btn" id="btnWithout" data-mode="without"><span>The Old Way</span></button>
            <button class="toggle-btn active" id="btnWith" data-mode="with"><span>With LümiCoin</span></button>
        </div>
        
        <div id="view-container">
            <!-- This container will be populated by JavaScript -->
        </div>

    </section>
    
    <hr id="results-hr" style="display:none;"/>

    <section id="results-section" style="display:none;">
      <div class="step-header"><div class="step-number">3</div><h2>The Journey & The Ledger</h2></div>
      <div class="grid" style="gap: 24px;">
          <div class="track-container">
            <div id="dividendVehicle"><span class="material-symbols-outlined">health_and_safety</span></div>
            <div class="track-line"></div>
            <div class="stations">
              <div class="station"><div class="payout"></div><div class="station-icon"></div><div class="station-name"></div></div>
              <div class="station"><div class="payout"></div><div class="station-icon"></div><div class="station-name"></div></div>
              <div class="station"><div class="payout"></div><div class="station-icon"></div><div class="station-name"></div></div>
              <div class="station"><div class="payout"></div><div class="station-icon"></div><div class="station-name"></div></div>
              <div class="station"><div class="payout"></div><div class="station-icon"></div><div class="station-name"></div></div>
            </div>
          </div>
          <div class="card results-grid">
              <div id="finalResultContainer">
                   <div id="finalResult" class="finalResult success"></div>
                   <div id="payerResult" class="finalResult payer"></div>
              </div>
              <div id="ledger">
                  <h3 style="text-align:center; margin: 0 0 20px; color: var(--ink-primary); font-size: 1.25rem;">The Ledger: Who Got Rewarded?</h3>
                  <div id="splitBreakdown"></div>
              </div>
          </div>
          <div id="analysis" class="show"></div>
      </div>
    </section>
  </div>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        const $ = sel => document.querySelector(sel);
        const $$ = sel => document.querySelectorAll(sel);

        let state = {
            action: "steps", qalyGain: 0.0005, qalyValue: 100000, dividendValue: 50,
            useLumicoin: true, running: false,
            splits: { patient: 0.75, provider: 0.10, system: 0.05, device: 0.04, platform: 0.04 }
        };

        const dom = {
            actionChoices: $$('#action-choices .choice-card'),
            qalyValueSlider: $('#qalyValue'), qalyValueLabel: $('#qalyValueLabel'),
            btnWith: $('#btnWith'), btnWithout: $('#btnWithout'),
            toggleSlider: $('#toggle-slider'), viewContainer: $('#view-container'),
            finalResult: $("#finalResult"), payerResult: $('#payerResult'),
            ledger: $("#ledger"), splitBreakdown: $("#splitBreakdown"), analysis: $('#analysis'),
            vehicle: $("#dividendVehicle"), stations: Array.from($$('.station')),
            trackContainer: $('.track-container'), resultsSection: $('#results-section'), resultsHr: $('#results-hr')
        };

        const formatUSD = n => n.toLocaleString("en-US", { style: "currency", currency: "USD" });

        const calculateDividend = () => {
            state.dividendValue = state.qalyGain * state.qalyValue;
        };

        const renderView = () => {
            calculateDividend();
            let html = '';
            let cardClasses = 'card';
            if (!state.useLumicoin) {
                cardClasses += ' danger-outline';
            }

            html = `<div class="${cardClasses}" style="animation: fadeIn 0.4s ease-out;">`;

            if (state.useLumicoin) {
                html += `
                    <label class="section-label">The health plan funds a "Health Dividend" from its prevention budget. This is not new spending; it's redirecting money from the "$1T Failure Budget."</label>
                    <div class="amount-wrapper success">
                        <div class="value-label">Calculated Health Dividend Value</div>
                        <div id="dividendLabel" class="value">${formatUSD(state.dividendValue)}</div>
                    </div>
                    <button id="btnSim" class="btn primary"><span class="material-symbols-outlined">play_arrow</span>Run the Simulation</button>`;
            } else {
                html += `
                    <label class="section-label">In the current system, the value of prevention is invisible and unrewarded. The health plan can only react to sickness later.</label>
                    <div class="amount-wrapper fail">
                        <div class="value-label">Potential Future Cost</div>
                        <div id="futureCostLabel" class="value">${formatUSD(state.dividendValue * 7)}</div>
                    </div>
                    <button id="btnDisabled" class="btn" disabled><span class="material-symbols-outlined">lock</span>Prevention Capital is Trapped</button>`;
            }
            html += `</div>`;
            dom.viewContainer.innerHTML = html;
            
            const btnSim = $('#btnSim');
            if (btnSim) {
                btnSim.addEventListener('click', runSimulation);
            }
        }

        const updateUI = () => {
            dom.actionChoices.forEach(c => c.classList.toggle('selected', c.dataset.action === state.action));
            dom.qalyValueLabel.textContent = formatUSD(state.qalyValue);
            
            dom.btnWith.classList.toggle('active', state.useLumicoin);
            dom.btnWithout.classList.toggle('active', !state.useLumicoin);
            
            if (dom.toggleSlider) {
                dom.toggleSlider.style.transform = `translate3d(${state.useLumicoin ? '100%' : '0'}, 0, 0)`;
            }
            renderView();
        };
        
        const resetVisuals = () => {
            dom.stations.forEach(s => {
                if (s) {
                    s.querySelector('.station-icon').className = 'station-icon';
                    s.querySelector('.payout').classList.remove('show');
                }
            });
            dom.resultsSection.style.display = 'none';
            dom.resultsHr.style.display = 'none';
            dom.finalResult.className = 'finalResult';
            dom.payerResult.className = 'finalResult payer';
            dom.ledger.classList.remove('show');
            dom.analysis.classList.remove('show');
            state.running = false;
            dom.vehicle.style.transform = `translate3d(42px, -24px, 0)`;
        };

        const runSimulation = async () => {
            if (state.running || !state.useLumicoin) return;
            resetVisuals();
            dom.resultsSection.style.display = 'block';
            dom.resultsHr.style.display = 'block';
            
            const btnSim = $('#btnSim');
            if(btnSim) btnSim.disabled = true;
            state.running = true;

            const journeyConfig = [
                { name: 'The Patient', icon: 'person', share: state.splits.patient, color: 'var(--patient-color)', desc: "Reward for doing the work & staying motivated." },
                { name: 'Their Doctor', icon: 'medical_services', share: state.splits.provider, color: 'var(--provider-color)', desc: "Incentive for keeping patients healthy." },
                { name: 'The Health System', icon: 'local_hospital', share: state.splits.system, color: 'var(--system-color)', desc: "A new revenue stream from prevention." },
                { name: 'The Tracking App/Device', icon: 'phone_iphone', share: state.splits.device, color: 'var(--device-color)', desc: "Gets a share for providing verifiable data." },
                { name: "LümiCoin's Rails", icon: 'hub', share: state.splits.platform, color: 'var(--platform-color)', desc: "Fee for operating the secure, auditable network." }
            ];

            dom.stations.forEach((stationEl, i) => {
                const config = journeyConfig[i];
                stationEl.querySelector('.station-icon').innerHTML = `<span class="material-symbols-outlined">${config.icon}</span>`;
                stationEl.querySelector('.station-name').textContent = config.name;
            });

            for (let i = 0; i < journeyConfig.length; i++) {
                const stationEl = dom.stations[i];
                const iconEl = stationEl.querySelector('.station-icon');
                const containerRect = dom.trackContainer.getBoundingClientRect();
                const iconRect = iconEl.getBoundingClientRect();
                const vehicleRect = dom.vehicle.getBoundingClientRect();
                const targetX = (iconRect.left + iconRect.width / 2) - containerRect.left - (vehicleRect.width / 2);
                
                dom.vehicle.style.transform = `translate3d(${targetX}px, -24px, 0)`;
                await new Promise(r => setTimeout(r, 800));
                iconEl.classList.add('success');
                
                const payoutAmount = state.dividendValue * journeyConfig[i].share;
                if (payoutAmount > 0.01) {
                    const payoutEl = stationEl.querySelector('.payout');
                    payoutEl.textContent = `+${formatUSD(payoutAmount)}`;
                    payoutEl.style.backgroundColor = journeyConfig[i].color;
                    payoutEl.style.borderTopColor = journeyConfig[i].color;
                    payoutEl.classList.add('show');
                }
                await new Promise(r => setTimeout(r, 400));
            }
            
            const totalPayout = state.dividendValue;
            const futureCost = totalPayout * 7;
            const netSavings = futureCost - totalPayout;

            dom.finalResult.innerHTML = `<div class="result-title"><span class="material-symbols-outlined">verified</span> Dividend Distributed!</div>
                <div class="reason"><b>${formatUSD(totalPayout)}</b> in value was created and shared, turning a potential future medical cost into a proactive investment.</div>`;
            dom.finalResult.classList.add('success', 'show');
            
            dom.payerResult.innerHTML = `<div class="result-title"><span class="material-symbols-outlined">savings</span> The Payer's Win: A Smarter Investment</div>
                <div class="reason">
                    By investing <b>${formatUSD(totalPayout)}</b> today, the plan avoids an estimated future cost of <b>${formatUSD(futureCost)}</b>, capturing a net savings of <b>${formatUSD(netSavings)}</b>.
                    <ul class="payer-benefits">
                        <li><span class="material-symbols-outlined">gavel</span><div><b>Avoids Rebates:</b> Helps meet federal spending rules on member care, avoiding millions in penalties.</div></li>
                        <li><span class="material-symbols-outlined">military_tech</span><div><b>Unlocks Bonuses:</b> Better health outcomes can lead to higher quality scores, unlocking millions in government bonuses.</div></li>
                        <li><span class="material-symbols-outlined">group</span><div><b>Wins Customers:</b> A healthier member base allows for more competitive plan pricing, attracting new business.</div></li>
                    </ul>
                </div>`;
            dom.payerResult.classList.add('payer', 'show');

            let breakdownHTML = journeyConfig.map(item => {
                const payout = state.dividendValue * item.share;
                return `<div class="split-row">
                    <div>
                        <div class="label" style="color:${item.color};"><span class="material-symbols-outlined">${item.icon}</span> ${item.name}</div>
                        <span class="label-desc">${item.desc}</span>
                    </div>
                    <span class="value" style="color:${item.color};">${formatUSD(payout)}</span>
                </div>`;
            }).join('');
            
            breakdownHTML += `<div class="split-row total-row"><div><strong class="label">Total Dividend Paid</strong></div><span class="value">${formatUSD(totalPayout)}</span></div>
            <div class="split-row total-row"><div><strong class="label" style="color: var(--success);">Estimated Future Savings</strong></div><span class="value" style="color: var(--success);">${formatUSD(netSavings)}</span></div>`;
            
            dom.splitBreakdown.innerHTML = breakdownHTML;
            dom.ledger.classList.add('show');
            
            dom.analysis.innerHTML = `<div class="analysis-card"><h4><span class="material-symbols-outlined">lightbulb</span>The Bottom Line for an Investor</h4><p>The Health Dividend creates a <b>win-win-win system</b>. The patient is rewarded, the healthcare system becomes more efficient, and prevention finally becomes a profitable, investable asset class. A small, proactive dividend today prevents a large, reactive cost tomorrow, generating significant ROI.</p></div>`;
            dom.analysis.classList.add('show');

            if(btnSim) btnSim.disabled = false;
            state.running = false;
        };
        
        dom.actionChoices.forEach(c => {
            c.addEventListener('click', () => {
                if(state.running) return;
                state.action = c.dataset.action;
                state.qalyGain = Number(c.dataset.qaly);
                updateUI();
                resetVisuals();
            });
        });
        
        dom.qalyValueSlider.addEventListener('input', e => {
            state.qalyValue = Number(e.target.value);
            updateUI();
        });

        const toggleMode = (useLumicoin) => {
            if(state.running) return;
            state.useLumicoin = useLumicoin;
            resetVisuals();
            updateUI();
        }

        dom.btnWith.addEventListener('click', () => toggleMode(true));
        dom.btnWithout.addEventListener('click', () => toggleMode(false));
        
        updateUI();
        resetVisuals();
        
        const observer = new MutationObserver((mutations) => {
            for(const mutation of mutations) {
                if (mutation.attributeName === 'style' && dom.resultsSection.style.display === 'block') {
                    setTimeout(() => {
                        dom.resultsSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
                    }, 100);
                }
            }
        });
        observer.observe(dom.resultsSection, { attributes: true, attributeFilter: ['style'] });
    });
</script>
</body>
</html>
